# 6장 키-값 저장소 설계

- 키-값 저장소(key-value store) 는 키-값 데이터베이스라고도 불리는 비 관계형(non-relational) 데이터베이스이다.

- 이 저장소에 저장되는 값은 고유 식별자(identifier)를 키로 가져야 한다.

- 키와 값 사이의 이런 연결 관계를 키-값 쌍(pair) 라고 지칭한다.

- key는 유일해야 하며, 값은 key를 통해서만 접근할 수 있다.

<br />

## 단일 서버 키-값 저장소

한 대 서버만 사용하는 키-값 저장소를 설계하는 것은 쉽다. 키-값 쌍 전부를 해쉬 테이블에 저장하는 것.

빠른 속도를 보장하지만 모든 데이터를 메모리안에 저장할 수 없다는 약점을 가지고 있다.

이를 위한 개선책으로는

- 데이터 압축
- 자주 쓰이는 데이터만 메모리에 두고 나머지는 디스크에 저장

그러나 위와 같은 방법을 통해 개선한다고 해도 한 대 서버로 부족한 순간이 찾아온다.

많은 데이터를 저장하려면 분산 키-값 저장소(distributed key-value store)를 만들 필요가 있다.

<br />

## 분산 키-값 저장소

분산 해시 테이블이라고도 불린다. 키-값 쌍을 여러 서버에 분산시키는 탓이다.

<br />

## CAP 정리

CAP 정리는 데이터 일관성(consistency), 가용성(availability), 파티션 감내(partion tolerance)라는

세 가지 요구사항을 동시에 만족하는 분산 시스템을 설계하는 것은 불가능하다는 정리다.

- 데이터 일관성 : 분산 시스템에 접속하는 모든 클라이언트는 어떤 노드에 접속했느냐에 관계없이 언제나 같은 데이터를 보게 되어야 한다.

- 가용성 : 분산 시스템에 접속하는 클라이언트는 일부 노드에 장애가 발생하더라도 항상 응답을 받을 수 있어야 한다.

- 파티션 감내 : 파티션은 두 노드 사이에 통신 장애가 발생하였음을 의미한다. 네트워크에 파티션이 생기더라도 시스템은 계속 동작하여야 한다는 것을 의미한다.

키-값 저장소는 위의 세 가지 요구사항중 어느 두 가지를 만족하느냐에 따라 다음과 같이 분류할 수 있다.

- CP 시스템 : 일관성과 파티션 감내를 지원하는 키-값 저장소, 가용성을 희생한다.
- AP 시스템 : 가용성과 파티션 감내를 지원하는 키-값 저장소, 데이터 일관성을 희생한다.
- CA 시스템 : 일관성과 가용성을 지원하는 키-값 저장소, 데이터 일관성을 희생한다. 실세계에 존재 x

<br />
